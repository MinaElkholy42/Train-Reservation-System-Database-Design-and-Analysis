CREATE TABLE Passengers
(
  Passenger_ID VARCHAR2(200),
  Date_of_Birth DATE NOT NULL,
  Gender VARCHAR2(20) NOT NULL,
  Passenger_First_Name VARCHAR2(100) NOT NULL,
  Passenger_Last_Name VARCHAR2(100) NOT NULL,
  PRIMARY KEY (Passenger_ID)
);

CREATE TABLE Passengers_Phones
(
  Phone_Number VARCHAR2(50) UNIQUE NOT NULL,
  Passenger_ID VARCHAR2(200) NOT NULL,
  PRIMARY KEY (Phone_Number, Passenger_ID),
  FOREIGN KEY (Passenger_ID) REFERENCES Passengers(Passenger_ID)
);

CREATE TABLE Tickets_Types
(
  Type_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1  ,
  Type_Name VARCHAR2(100) NOT NULL,
  Description VARCHAR2(200) NOT NULL,
  PRIMARY KEY (Type_ID),
  UNIQUE (Type_Name)
);

CREATE TABLE Services
(
  Service_ID  NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1,
  Service_Name VARCHAR2(100) NOT NULL,
  Explanation VARCHAR2(200) NOT NULL,
  PRIMARY KEY (Service_ID),
  UNIQUE (Service_Name)
);

CREATE TABLE Trains
(
  Train_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1,
  Train_Type VARCHAR2(100) NOT NULL,
  Train_Stopping_Stations VARCHAR2(200) NOT NULL,
  Trib_Deprature_Time TIMESTAMP NOT NULL,
  Trib_Arrival_Time TIMESTAMP NOT NULL,
  PRIMARY KEY (Train_ID)
);

CREATE TABLE Seats
(
  Seat_Number NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1 NOT NULL,
  Row_Number INT NOT NULL,
  Column_Number VARCHAR2(10) NOT NULL,
  Cart_Number INT NOT NULL,
  Seat_Type VARCHAR2(50) NOT NULL,
  Train_ID NUMBER NOT NULL,
  PRIMARY KEY (Seat_Number, Train_ID),
  FOREIGN KEY (Train_ID) REFERENCES Trains(Train_ID)
);

CREATE TABLE Tickets_Types_Services
(
  Type_ID NUMBER NOT NULL,
  Service_ID NUMBER NOT NULL,
  PRIMARY KEY (Type_ID, Service_ID),
  FOREIGN KEY (Type_ID) REFERENCES Tickets_Types(Type_ID),
  FOREIGN KEY (Service_ID) REFERENCES Services(Service_ID)
);

CREATE TABLE Ticket_Types_Trains
(
  Type_ID NUMBER NOT NULL,
  Train_ID NUMBER NOT NULL,
  PRIMARY KEY (Type_ID, Train_ID),
  FOREIGN KEY (Type_ID) REFERENCES Tickets_Types(Type_ID),
  FOREIGN KEY (Train_ID) REFERENCES Trains(Train_ID)
);

CREATE TABLE Employees
(
  Employee_ID VARCHAR2(200),
  Date_of_Birth DATE NOT NULL,
  Employee_Role VARCHAR2(100) NOT NULL,
  Gender VARCHAR2(20) NOT NULL,
  Employee_First_Name VARCHAR2(100) NOT NULL,
  Employee_Last_Name VARCHAR2(100) NOT NULL,
  Salary FLOAT NOT NULL,
  Block_Number INT NOT NULL,
  Street VARCHAR2(100) NOT NULL,
  City VARCHAR2(100) NOT NULL,
  WORK_START_TIME TIMESTAMP NOT NULL,
  Work_End_Time TIMESTAMP  NOT NULL,
  Supervisor_ID VARCHAR2(200),
  PRIMARY KEY (Employee_ID),
  FOREIGN KEY (Supervisor_ID) REFERENCES Employees(Employee_ID)
);

CREATE TABLE Employees_Phones
(
  Phone_Number VARCHAR2(50) UNIQUE NOT NULL,
  Employee_ID VARCHAR2(200) NOT NULL,
  PRIMARY KEY (Phone_Number, Employee_ID),
  FOREIGN KEY (Employee_ID) REFERENCES Employees(Employee_ID)
);

CREATE TABLE Payments
(
  Payment_Number  NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1,
  Payment_Method VARCHAR2(100) NOT NULL,
  Discount FLOAT NOT NULL,
  Total_Price FLOAT NOT NULL,
  Payment_Date DATE NOT NULL,
  Payment_Time TIMESTAMP NOT NULL,
  Employee_ID VARCHAR2(200) NOT NULL,
  Passenger_ID VARCHAR2(200) NOT NULL,
  PRIMARY KEY (Payment_Number),
  FOREIGN KEY (Employee_ID) REFERENCES Employees(Employee_ID),
  FOREIGN KEY (Passenger_ID) REFERENCES Passengers(Passenger_ID)
);

CREATE TABLE Tickets
(
  Ticket_Number NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1 NOT NULL,
  Waiting_Station VARCHAR2(100) NOT NULL,
  Waiting_Date DATE NOT NULL,
  Waiting_Time TIMESTAMP NOT NULL,
  Ticket_Price FLOAT NOT NULL,
  Payment_Number NUMBER NOT NULL,
  Employee_ID VARCHAR2(200) NOT NULL,
  Passenger_ID VARCHAR2(200) NOT NULL,
  Type_ID NUMBER NOT NULL,
  Seat_Number NUMBER NOT NULL,
  Train_ID NUMBER NOT NULL,
  PRIMARY KEY (Ticket_Number, Payment_Number, Employee_ID, Passenger_ID, Type_ID, Seat_Number, Train_ID),
  FOREIGN KEY (Payment_Number) REFERENCES Payments(Payment_Number),
  FOREIGN KEY (Employee_ID) REFERENCES Employees(Employee_ID),
  FOREIGN KEY (Passenger_ID) REFERENCES Passengers(Passenger_ID),
  FOREIGN KEY (Type_ID) REFERENCES Tickets_Types(Type_ID),
  FOREIGN KEY (Seat_Number, Train_ID) REFERENCES Seats(Seat_Number, Train_ID)
);